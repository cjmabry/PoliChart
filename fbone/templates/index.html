{% extends 'layouts/base.html' %}

{% set page_title = 'Home' %}

{% block top %}
{% endblock %}

{% block body %}
<div class="jumbotron">
    <h1>Delegate Predictions</h1>
    <p>This tool displays how many delegates each candidate would win if each primary happened today and if the results lined up with current polling.</p>
    <h4>Hillary Clinton: {{ data.projections.clinton }}</h4>
    <h4>Bernie Sanders: {{ data.projections.sanders }}</h4>

    <small>Polling data from <a href="http://elections.huffingtonpost.com/pollster#2016-primaries">HuffPost Pollster</a></small>
</div>

<div class="panel panel-default">
  <!-- Default panel contents -->
  <div class="panel-heading">State Breakdowns</div>

  <!-- Table -->
  <table class="table">
    <thead>
      <tr>
        <th colspan='1'></th>
        <th colspan='3' scope='colgroup'>Delegates Available</th>
        <th colspan='3' scope='colgroup'>Polling</th>
        <th colspan='3' scope='colgroup'>Projected Delegates</th>
        <th colspan='1'></th>
        <th colspan='1'></th>
      </tr>
      <tr>
        <th scope='col'>State</th>
        <th scope='col'>Pledged</th>
        <th scope='col'>Unpledged</th>
        <th scope='col'>Total</th>
        <th scope='col'>Clinton</th>
        <th scope='col'>Sanders</th>
        <th scope='col'>Undecided</th>
        <th scope='col'>Clinton</th>
        <th scope='col'>Sanders</th>
        <th scope='col'>Undecided</th>
        <th scope='col'>Election Date</th>
        <th scope='col'>Last Updated</th>
      </tr>
    </thead>
    <tbody>
      {% for state in data.states %}
        {% if state.state != 'US' %}
          <tr>
            <td>{{ state.state }}</td>
            <td>{{ state.pledged_available }}</td>
            <td>{{ state.unpledged_available }}</td>
            <td>{{ state.unpledged_available + state.pledged_available }}</td>
            <td>
              {% if state.url %}
                <a href="{{state.url}}">{{ state.clinton_percentage * 100 }}%</a>
              {% else %}
                {{ state.clinton_percentage * 100 }}%
              {% endif %}
          </td>
            <td>
              {% if state.url %}
                <a href="{{state.url}}">{{ state.sanders_percentage * 100 }}%</a>
              {% else %}
                {{ state.sanders_percentage * 100 }}%
              {% endif %}
            </td>
            <td>{{ 100 - (state.sanders_percentage + state.clinton_percentage) * 100}}%</td>
            <td>{{ state.clinton_delegates | int }}</td>
            <td>{{ state.sanders_delegates | int}}</td>
            <td>{{ state.pledged_available - (state.sanders_delegates + state.clinton_delegates) | int}}</td>
            <td>{{ state.election_date }}</td>
            <td>{{ state.last_updated }}</td>
          </tr>
        {% endif %}
      {% endfor %}

      {% for state in data.states %}
        {% if state.state == 'US' %}
        <tr>
          <td><strong>TOTAL</strong></td>
          <td>{{ state.pledged_available }}</td>
          <td>{{ state.unpledged_available }}</td>
          <td>{{ state.unpledged_available + state.pledged_available }}</td>
          <td>
            {% if state.url %}
              <a href="{{state.url}}">{{ state.clinton_percentage * 100 }}%</a>
            {% else %}
              {{ state.clinton_percentage * 100 }}%
            {% endif %}
        </td>
          <td>
            {% if state.url %}
              <a href="{{state.url}}">{{ state.sanders_percentage * 100 }}%</a>
            {% else %}
              {{ state.sanders_percentage * 100 }}%
            {% endif %}
          </td>
          <td>{{ 100 - (state.sanders_percentage + state.clinton_percentage) * 100}}%</td>
          <td>{{ state.clinton_delegates | int }}</td>
          <td>{{ state.sanders_delegates | int}}</td>
          <td>{{ state.pledged_available - (state.sanders_delegates + state.clinton_delegates) | int}}</td>
          <td>{{ state.election_date }}</td>
          <td>{{ state.last_updated }}</td>
        </tr>
        {% endif %}
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
