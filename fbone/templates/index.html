{% extends 'layouts/base.html' %}

{% set page_title = 'Home' %}

{% block top %}
{% endblock %}

{% block body %}
<div class="jumbotron" id="about">
    <h1>The State of the Democratic Race</h1>

    <p>Unlike on the Republican side, the Democrats allocate delegates for each state proportionally to the popular vote of each state. Because of this, we can use recent polling to project how many delegates each candidate is likely to recieve.</p>

    <p>Questions? Check out our <a href="#">FAQ</a>.</p>

    <small>Polling data from <a href="http://elections.huffingtonpost.com/pollster#2016-primaries">HuffPost Pollster</a></small>

</div>

<div class="row">
  <div class="col-md-12 clearfix">
    <div class="pull-left">
      <h4>Hillary Clinton</h4>
      <p class="bar-delegates">{{ data.projections.clinton }} delegates ({{ (data.projections.clinton / (data.projections.sanders + data.projections.clinton + data.projections.undecided) * 100) | round(1) }}%)</p>
    </div>

    <div class="pull-right text-right">
      <h4>Bernie Sanders</h4>
      <p class="bar-delegates">{{ data.projections.sanders }} delegates ({{ (data.projections.sanders / (data.projections.sanders + data.projections.clinton + data.projections.undecided) * 100) | round(1) }}%)</p>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <div class="progress">
      <div class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: {{ (data.projections.clinton / (data.projections.sanders + data.projections.clinton + data.projections.undecided) * 100) | round(1) }}%;">
      </div>
      <div class="target"></div>
      <div class="progress-bar pull-right progress-bar-striped" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: {{ (data.projections.sanders / (data.projections.sanders + data.projections.clinton + data.projections.undecided) * 100) | round(1) }}%;">
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <div class="well">
      <p>As of now, Secretary Hillary Clinton is projected to receive <strong>{{ data.projections.clinton }}</strong> pledged delegates, while Senator Bernie Sanders is projected to receive <strong>{{ data.projections.sanders }}</strong> pledged delegates. The other <strong>{{ data.projections.undecided }}</strong> pledged delegates could go to either candidate, as there is not enough current polling in those states to make an accurate prediction at this time.</p>

      <p><strong>Check back later for more results. As more polls roll in, our projections will improve.</strong></p>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <h3>The Data<h3>

    <div class="table-responsive">

      <!-- Table -->
      <table class="table table-condensed table-striped table-hover table-bordered" id="state-data">
        <thead>
          <tr>
            <th colspan='1'></th>
            <th colspan='1' scope='colgroup'>Delegates</th>
            <th colspan='2' scope='colgroup'>Polling</th>
            <th colspan='2' scope='colgroup'>Results</th>
            <th colspan='3' scope='colgroup'>Projected Delegates</th>
            <th colspan='2' scope='colgroup'>Awarded Delegates</th>
            <th colspan='1'></th>
          </tr>
          <tr>
            <th scope='col'>State</th>
            <th scope='col'>Pledged</th>
            <!-- <th scope='col'>Unpledged</th> -->
            <!-- <th scope='col'>Total</th> -->
            <th scope='col'>Clinton</th>
            <th scope='col'>Sanders</th>
            <!-- <th scope='col'>Undecided</th> -->
            <th scope='col'>Clinton</th>
            <th scope='col'>Sanders</th>
            <th scope='col'>Clinton</th>
            <th scope='col'>Sanders</th>
            <th scope='col'>Undecided</th>
            <th scope='col'>Clinton</th>
            <th scope='col'>Sanders</th>
            <th scope='col' class='sort-default'>Election Date</th>
          </tr>
        </thead>
        <tbody>
          {% for state in data.states %}
            {% if state.state != 'US' %}
              <tr>
                <td><strong>{{ state.state }}</strong></td>
                <td>{{ state.pledged_available }}</td>
                <!-- <td>{{ state.unpledged_available }}</td> -->
                <!-- <td>{{ state.unpledged_available + state.pledged_available }}</td> -->
                <td>
                  {% if state.url %}
                    <a href="{{state.url}}">{{ state.clinton_percentage * 100 }}%</a>
                  {% else %}
                    {{ state.clinton_percentage * 100 }}%
                  {% endif %}
              </td>
                <td>
                  {% if state.url %}
                    <a href="{{state.url}}">{{ state.sanders_percentage * 100 }}%</a>
                  {% else %}
                    {{ state.sanders_percentage * 100 }}%
                  {% endif %}
                </td>
                <!-- <td>{{ 100 - (state.sanders_percentage + state.clinton_percentage) * 100}}%</td> -->
                <td>
                  {% if state.clinton_percentage_results %}
                    {{ state.clinton_percentage_results }}%
                  {% else %}
                    -
                  {% endif %}
                </td>
                <td>
                  {% if state.sanders_percentage_results %}
                    {{ state.sanders_percentage_results }}%
                  {% else %}
                    -
                  {% endif %}
                </td>
                <td>{{ state.clinton_delegates | int }}</td>
                <td>{{ state.sanders_delegates | int}}</td>
                <td>{{ state.pledged_available - (state.sanders_delegates + state.clinton_delegates) | int}}</td>
                <td>
                  {% if state.clinton_delegates_results %}
                    {{ state.clinton_delegates_results }}
                  {% else %}
                    -
                  {% endif %}
                </td>
                <td>
                  {% if state.sanders_delegates_results %}
                    {{ state.sanders_delegates_results }}
                  {% else %}
                    -
                  {% endif %}
                </td>
                <td>{{ state.election_date.strftime('%m/%d/%Y') }}</td>
              </tr>
            {% endif %}
          {% endfor %}

          {% for state in data.states %}
            {% if state.state == 'US' %}
            <tr class="panel-footer no-sort">
              <td><strong>TOTAL</strong></td>
              <td>{{ state.pledged_available }}</td>
              <!-- <td>{{ state.unpledged_available }}</td> -->
              <!-- <td>{{ state.unpledged_available + state.pledged_available }}</td> -->
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <!-- <td>-</td> -->
              <td>-</td>
              <td><strong>{{ data.projections.clinton }}</strong></td>
              <td><strong>{{ data.projections.sanders }}</strong></td>
              <td><strong>{{ data.projections.undecided }}</strong></td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
            </tr>
            {% endif %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
